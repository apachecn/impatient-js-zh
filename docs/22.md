## 18.å­—ç¬¦ä¸²

> åŸæ–‡ï¼š [http://exploringjs.com/impatient-js/ch_strings.html](http://exploringjs.com/impatient-js/ch_strings.html)
> 
> è´¡çŒ®è€…ï¼š[é£é¾™](https://github.com/wizardforcel)

å­—ç¬¦ä¸²æ˜¯ JavaScript ä¸­çš„åŸå§‹å€¼å’Œä¸å¯å˜å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å­—ç¬¦ä¸²ç›¸å…³çš„æ“ä½œæ€»æ˜¯ä¼šç”Ÿæˆæ–°çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”æ°¸è¿œä¸ä¼šæ›´æ”¹ã€‚

### 18.1ã€‚æ™®é€šå­—ç¬¦ä¸²å­—é¢å€¼

çº¯å­—ç¬¦ä¸²å­—é¢å€¼ç”±å•å¼•å·æˆ–åŒå¼•å·åˆ†éš”ï¼š

```js
const str1 = 'abc';
const str2 = "abc";
assert.equal(str1, str2);
```

å•å¼•å·æ›´å¸¸ç”¨ï¼Œå› ä¸ºå®ƒæ›´å®¹æ˜“ç¼–å†™ HTMLï¼Œå…¶ä¸­æ¨èåŒå¼•å·ã€‚

[ä¸‹ä¸€ç« ](ch_template-literals.html)æ¶µç›–*æ¨¡æ¿å­—é¢å€¼*ï¼Œå®ƒä»¬ä¸ºæ‚¨æä¾›ï¼š

*   å­—ç¬¦ä¸²æ’å€¼
*   å¤šè¡Œ
*   åŸå§‹å­—ç¬¦ä¸²å­—é¢å€¼ï¼ˆåæ–œæ æ²¡æœ‰ç‰¹æ®Šå«ä¹‰ï¼‰

#### 18.1.1ã€‚è½¬ä¹‰

åæ–œæ å¯è®©æ‚¨åˆ›å»ºç‰¹æ®Šå­—ç¬¦ï¼š

*   Unix æ¢è¡Œç¬¦ï¼š`'\n'`
*   Windows æ¢è¡Œç¬¦ï¼š`'\r\n'`
*   æ ‡ç­¾ï¼š`'\t'`
*   åæ–œæ ï¼š`'\\'`

åæ–œæ è¿˜å…è®¸æ‚¨åœ¨å­—é¢å€¼å†…ä½¿ç”¨å­—ç¬¦ä¸²å­—é¢å€¼çš„åˆ†éš”ç¬¦ï¼š

```js
'She said: "Let\'s go!"'
"She said: \"Let's go!\""
```

### 18.2ã€‚è®¿é—®å­—ç¬¦å’Œä»£ç ç‚¹

#### 18.2.1ã€‚è®¿é—® JavaScript å­—ç¬¦

JavaScript æ²¡æœ‰å­—ç¬¦çš„é¢å¤–æ•°æ®ç±»å‹ - å­—ç¬¦æ€»æ˜¯ä½œä¸ºå­—ç¬¦ä¸²ä¼ è¾“ã€‚

```js
const str = 'abc';

// Reading a character at a given index
assert.equal(str[1], 'b');

// Counting the characters in a string:
assert.equal(str.length, 3);
```

#### 18.2.2ã€‚é€šè¿‡`for-of`è®¿é—® Unicode ä»£ç ç‚¹ä»¥åŠå±•å¼€

é€šè¿‡`for-of`æˆ–å±•å¼€ï¼ˆ`...`ï¼‰è¿­ä»£å­—ç¬¦ä¸²è®¿é—® Unicode ä»£ç ç‚¹ã€‚æ¯ä¸ªä»£ç ç‚¹ç”± 1-2 ä¸ª JavaScript å­—ç¬¦è¡¨ç¤ºã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[æ–‡æœ¬åŸå­](ch_strings.html#atoms-of-text)éƒ¨åˆ†ã€‚

è¿™æ˜¯é€šè¿‡`for-of`è¿­ä»£å­—ç¬¦ä¸²çš„ä»£ç ç‚¹çš„æ–¹æ³•ï¼š

```js
for (const ch of 'abc') {
  console.log(ch);
}
// Output:
// 'a'
// 'b'
// 'c'
```

è¿™å°±æ˜¯é€šè¿‡å±•å¼€å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºä»£ç ç‚¹æ•°ç»„çš„æ–¹æ³•ï¼š

```js
assert.deepEqual([...'abc'], ['a', 'b', 'c']);
```

### 18.3ã€‚é€šè¿‡`+`è¿›è¡Œå­—ç¬¦ä¸²è¿æ¥

å¦‚æœè‡³å°‘æœ‰ä¸€ä¸ªæ“ä½œæ•°æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™åŠ å·è¿ç®—ç¬¦ï¼ˆ`+`ï¼‰å°†ä»»ä½•éå­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶è¿æ¥ç»“æœï¼š

```js
assert.equal(3 + ' times ' + 4, '3 times 4');
```

å¦‚æœè¦é€ä¸ªç»„åˆå­—ç¬¦ä¸²ï¼Œåˆ™èµ‹å€¼è¿ç®—ç¬¦`+=`éå¸¸æœ‰ç”¨ï¼š

```js
let str = ''; // must be `let`!
str += 'Say it';
str += ' one more';
str += ' time';

assert.equal(str, 'Say it one more time');
```

é¡ºä¾¿è¯´ä¸€å¥ï¼Œè¿™ç§ç»„åˆå­—ç¬¦ä¸²çš„æ–¹å¼éå¸¸æœ‰æ•ˆï¼Œå› ä¸ºå¤§å¤šæ•° JavaScript å¼•æ“éƒ½åœ¨å†…éƒ¨ä¼˜åŒ–å®ƒã€‚

![](img/326f85074b5e7828bef014ad113651df.svg) **ç»ƒä¹ ï¼šè¿æ¥å­—ç¬¦ä¸²**

`exercises/strings/concat_string_array_test.js`

### 18.4ã€‚è½¬æ¢ä¸ºå­—ç¬¦ä¸²

è¿™æ˜¯å°†å€¼`x`è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„ä¸‰ç§æ–¹æ³•ï¼š

*   `String(x)`
*   `''+x`
*   `x.toString()`ï¼ˆå¯¹`undefined`å’Œ`null`ä¸èµ·ä½œç”¨ï¼‰

å»ºè®®ï¼šä½¿ç”¨æè¿°æ€§å’Œå®‰å…¨çš„`String()`ã€‚

ä¾‹å­ï¼š

```js
assert.equal(String(undefined), 'undefined');
assert.equal(String(null), 'null');

assert.equal(String(false), 'false');
assert.equal(String(true), 'true');

assert.equal(String(123.45), '123.45');
```

å¸ƒå°”å€¼çš„é™·é˜±ï¼šå¦‚æœé€šè¿‡`String()`å°†å¸ƒå°”å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œåˆ™æ— æ³•é€šè¿‡`Boolean()`å°†å…¶è½¬æ¢å›æ¥ã€‚

```js
> String(false)
'false'
> Boolean('false')
true
```

#### 18.4.1ã€‚å­—ç¬¦ä¸²åŒ–å¯¹è±¡

æ™®é€šå¯¹è±¡å…·æœ‰ä¸€ä¸ªä¸å¤ªæœ‰ç”¨çš„é»˜è®¤è¡¨ç¤ºï¼š

```js
> String({a: 1})
'[object Object]'
```

æ•°ç»„æœ‰æ›´å¥½çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œä½†å®ƒä»ç„¶éšè—äº†å¾ˆå¤šä¿¡æ¯ï¼š

```js
> String(['a', 'b'])
'a,b'
> String(['a', ['b']])
'a,b'

> String([1, 2])
'1,2'
> String(['1', '2'])
'1,2'

> String([true])
'true'
> String(['true'])
'true'
> String(true)
'true'
```

å­—ç¬¦ä¸²åŒ–å‡½æ•°è¿”å›å…¶æºä»£ç ï¼š

```js
> String(function f() {return 4})
'function f() {return 4}'
```

#### 18.4.2ã€‚è‡ªå®šä¹‰å¯¹è±¡çš„å­—ç¬¦ä¸²åŒ–

æ‚¨å¯ä»¥é€šè¿‡å®ç°æ–¹æ³•`toString()`æ¥è¦†ç›–å­—ç¬¦ä¸²åŒ–å¯¹è±¡çš„å†…ç½®æ–¹å¼ï¼š

```js
const obj = {
  toString() {
    return 'hello';
  }
};

assert.equal(String(obj), 'hello');
```

#### 18.4.3ã€‚å­—ç¬¦ä¸²åŒ–å€¼çš„å¦ä¸€ç§æ–¹æ³•

JSON æ•°æ®æ ¼å¼æ˜¯ JavaScript å€¼çš„æ–‡æœ¬è¡¨ç¤ºã€‚å› æ­¤ï¼Œ`JSON.stringify()`ä¹Ÿå¯ç”¨äºå­—ç¬¦ä¸²åŒ–æ•°æ®ï¼š

```js
> JSON.stringify({a: 1})
'{"a":1}'
> JSON.stringify(['a', ['b']])
'["a",["b"]]'
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒJSON ä»…æ”¯æŒ`null`ï¼Œå¸ƒå°”å€¼ï¼Œæ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œæ•°ç»„å’Œå¯¹è±¡ï¼ˆå®ƒæ€»æ˜¯å°†å®ƒä»¬è§†ä¸ºç”±å¯¹è±¡å­—é¢å€¼åˆ›å»ºï¼‰ã€‚

æç¤ºï¼šç¬¬ä¸‰ä¸ªå‚æ•°å…è®¸æ‚¨æ‰“å¼€å¤šè¡Œè¾“å‡ºå¹¶æŒ‡å®šç¼©è¿›é‡ã€‚ä¾‹å¦‚ï¼š

```js
console.log(JSON.stringify({first: 'Jane', last: 'Doe'}, null, 2));
```

è¯¥è¯­å¥äº§ç”Ÿä»¥ä¸‹è¾“å‡ºã€‚

```json
{
  "first": "Jane",
  "last": "Doe"
}
```

### 18.5ã€‚æ¯”è¾ƒå­—ç¬¦ä¸²

å¯ä»¥é€šè¿‡ä»¥ä¸‹è¿ç®—ç¬¦æ¯”è¾ƒå­—ç¬¦ä¸²ï¼š

```js
< <= > >=
```

éœ€è¦è€ƒè™‘ä¸€ä¸ªé‡è¦çš„è­¦å‘Šï¼šè¿™äº›è¿ç®—ç¬¦åŸºäº JavaScript å­—ç¬¦çš„æ•°å€¼è¿›è¡Œæ¯”è¾ƒã€‚è¿™æ„å‘³ç€ JavaScript ç”¨äºå­—ç¬¦ä¸²çš„é¡ºåºä¸å­—å…¸å’Œç”µè¯ç°¿ä¸­ä½¿ç”¨çš„é¡ºåºä¸åŒï¼š

```js
> 'A' < 'B' // ok
true
> 'a' < 'B' // not ok
false
> 'Ã¤' < 'b' // not ok
false
```

æ­£ç¡®æ¯”è¾ƒæ–‡æœ¬è¶…å‡ºäº†æœ¬ä¹¦çš„èŒƒå›´ã€‚å®ƒé€šè¿‡[ ECMAScript å›½é™…åŒ– APIï¼ˆ`Intl`ï¼‰](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Intl)å¾—åˆ°æ”¯æŒã€‚

### 18.6ã€‚æ–‡æœ¬åŸå­ï¼šJavaScript å­—ç¬¦ï¼Œä»£ç ç‚¹ï¼Œå­—å½¢ç°‡

å¿«é€Ÿå›é¡¾[å…³äº Unicode](ch_unicode.html) çš„ç« èŠ‚ï¼š

*   ä»£ç ç‚¹ï¼šUnicode å­—ç¬¦ï¼ŒèŒƒå›´ä¸ºâ€‹â€‹ 21 ä½ã€‚
*   UTF-16 ä»£ç å•å…ƒï¼šJavaScript å­—ç¬¦ï¼ŒèŒƒå›´ä¸º â€‹â€‹16 ä½ã€‚ä»£ç ç‚¹ç¼–ç ä¸º 1-2 ä¸ª UTF-16 ä»£ç å•å…ƒã€‚
*   å­—å½¢ç°‡ï¼š*å­—ç´ *æ˜¯ä¹¦é¢ç¬¦å·ï¼Œæ˜¾ç¤ºåœ¨å±å¹•æˆ–çº¸ä¸Šã€‚*å­—å½¢ç°‡*æ˜¯ç¼–ç å­—ç´ çš„ 1 ä¸ªæˆ–å¤šä¸ªä»£ç ç‚¹çš„åºåˆ—ã€‚

è¦åœ¨ JavaScript å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºä»£ç ç‚¹ï¼Œè¯·ä½¿ç”¨ä¸€ä¸ªæˆ–ä¸¤ä¸ª JavaScript å­—ç¬¦ã€‚é€šè¿‡`.length`è®¡ç®—å­—ç¬¦æ—¶å¯ä»¥çœ‹åˆ°ï¼š

```js
// 3 Unicode code points, 3 JavaScript characters:
assert.equal('abc'.length, 3);

// 1 Unicode code point, 2 JavaScript characters:
assert.equal('ğŸ™‚'.length, 2);
```

#### 18.6.1ã€‚ä½¿ç”¨ä»£ç ç‚¹

è®©æˆ‘ä»¬æ¢ç´¢ JavaScript ç”¨äºå¤„ç†ä»£ç ç‚¹çš„å·¥å…·ã€‚

*ä»£ç ç‚¹è½¬ä¹‰*å…è®¸æ‚¨ä»¥åå…­è¿›åˆ¶çš„æ–¹å¼æŒ‡å®šä»£ç ç‚¹ã€‚å®ƒä»¬æ‰©å±•ä¸ºä¸€ä¸ªæˆ–ä¸¤ä¸ª JavaScript å­—ç¬¦ã€‚

```js
> '\u{1F642}'
'ğŸ™‚'
```

ä»ä»£ç ç‚¹è½¬æ¢ï¼š

```js
> String.fromCodePoint(0x1F642)
'ğŸ™‚'
```

è½¬æ¢ä¸ºä»£ç ç‚¹ï¼š

```js
> 'ğŸ™‚'.codePointAt(0).toString(16)
'1f642'
```

è¿­ä»£ä»£ç ç‚¹ã€‚ä¾‹å¦‚ï¼ŒåŸºäºè¿­ä»£çš„`for-of`å¾ªç¯ï¼š

```js
const str = 'ğŸ™‚a';
assert.equal(str.length, 3);

for (const codePoint of str) {
  console.log(codePoint);
}

// Output:
// 'ğŸ™‚'
// 'a'
```

æˆ–åŸºäºè¿­ä»£çš„å±•å¼€ï¼ˆ`...`ï¼‰ï¼š

```js
> [...'ğŸ™‚a']
[ 'ğŸ™‚', 'a' ]
```

å› æ­¤ï¼Œå±•å¼€æ˜¯è®¡ç®—ä»£ç ç‚¹çš„å¥½å·¥å…·ï¼š

```js
> [...'ğŸ™‚a'].length
2
> 'ğŸ™‚a'.length
3
```

#### 18.6.2ã€‚ä½¿ç”¨ä»£ç å•å…ƒ

å­—ç¬¦ä¸²çš„ç´¢å¼•å’Œé•¿åº¦åŸºäº JavaScript å­—ç¬¦ï¼ˆå³ä»£ç å•å…ƒï¼‰ã€‚

è¦ä»¥æ•°å­—æ–¹å¼æŒ‡å®šä»£ç å•å…ƒï¼Œå¯ä»¥ä½¿ç”¨*ä»£ç å•å…ƒè½¬ä¹‰*ï¼š

```js
> '\uD83D\uDE42'
'ğŸ™‚'
```

ä½ å¯ä»¥ä½¿ç”¨æ‰€è°“çš„*å­—ç¬¦ä»£ç *ï¼š

```js
> String.fromCharCode(0xD83D) + String.fromCharCode(0xDE42)
'ğŸ™‚'
```

è¦è·å–å­—ç¬¦çš„å­—ç¬¦ä»£ç ï¼Œè¯·ä½¿ç”¨`.charCodeAt()`ï¼š

```js
> 'ğŸ™‚'.charCodeAt(0).toString(16)
'd83d'
```

#### 18.6.3ã€‚è­¦å‘Šï¼šå­—å½¢ç°‡

å¤„ç†å¯èƒ½ä½¿ç”¨ä»»ä½•äººç±»è¯­è¨€ç¼–å†™çš„æ–‡æœ¬æ—¶ï¼Œæœ€å¥½åœ¨å­—å½¢ç°‡çš„è¾¹ç•Œå¤„è¿›è¡Œæ‹†åˆ†ï¼Œè€Œä¸æ˜¯åœ¨ä»£ç å•å…ƒçš„è¾¹ç•Œå¤„è¿›è¡Œæ‹†åˆ†ã€‚

TC39 æ­£åœ¨å¼€å‘[`Intl.Segmenter`](https://github.com/tc39/proposal-intl-segmenter)ï¼Œè¿™æ˜¯ä¸€é¡¹æ”¯æŒ ECMAScript å›½é™…åŒ– API çš„æè®®ï¼Œæ”¯æŒ Unicode åˆ†æ®µï¼ˆæ²¿ç€å­—å½¢ç°‡è¾¹ç•Œï¼Œå­—è¾¹ç•Œï¼Œå¥å­è¾¹ç•Œç­‰ï¼‰ã€‚

åœ¨è¯¥ææ¡ˆæˆä¸ºæ ‡å‡†ä¹‹å‰ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å‡ ä¸ªå¯ç”¨åº“ä¸­çš„ä¸€ä¸ªï¼ˆå¯¹â€œJavaScript å­—å½¢â€è¿›è¡Œ Web æœç´¢ï¼‰ã€‚

### 18.7ã€‚å¿«é€Ÿå‚è€ƒï¼šå­—ç¬¦ä¸²

å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œæ²¡æœ‰ä»»ä½•å­—ç¬¦ä¸²æ–¹æ³•å¯ä»¥ä¿®æ”¹å®ƒä»¬ã€‚

#### 18.7.1ã€‚è½¬æ¢ä¸ºå­—ç¬¦ä¸²

TBLã€‚ [16](#tbl:converting-to-string) æè¿°äº†å„ç§å€¼å¦‚ä½•è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚

Table 16: Converting values to strings.

| `x` | `String(x)` |
| --- | --- |
| `undefined` | `'undefined'` |
| `null` | `'null'` |
| å¸ƒå°”å€¼ | `false â†’ 'false'`ï¼Œ`true â†’ 'true'` |
| æ•°å€¼ | ç¤ºä¾‹ï¼š`123 â†’ '123'` |
| å­—ç¬¦ä¸²å€¼ | `x`ï¼ˆè¾“å…¥ï¼Œæœªæ›´æ”¹ï¼‰ |
| å¯¹è±¡ | å¯é…ç½®ï¼Œä¾‹å¦‚é€šè¿‡`toString()` |

#### 18.7.2ã€‚å­—ç¬¦å’Œä»£ç ç‚¹çš„æ•°å­—å€¼

*   **å­—ç¬¦ä»£ç ï¼š** ä½¿ç”¨æ•°å€¼è¡¨ç¤º JavaScript å­—ç¬¦ï¼ŒUnicode ä»£ç å•å…ƒçš„ JavaScript åç§°
    *   `String.fromCharCode()`ï¼Œ`String.prototype.charCodeAt()`
    *   ç²¾åº¦ï¼š16 ä½ï¼Œæ— ç¬¦å·
*   **ä»£ç ç‚¹ï¼š** ä½¿ç”¨æ•°å€¼è¡¨ç¤º Unicode å­—ç¬¦
    *   `String.fromCodePoint()`ï¼Œ`String.prototype.codePointAt()`
    *   ç²¾åº¦ï¼š21 ä½ï¼Œæ— ç¬¦å·ï¼ˆ17 ä¸ªå¹³é¢ï¼Œæ¯ä¸ª 16 ä½ï¼‰

#### 18.7.3ã€‚å­—ç¬¦ä¸²è¿ç®—ç¬¦

```js
// Access characters via []
const str = 'abc';
assert.equal(str[1], 'b');

// Concatenate strings via +
assert.equal('a' + 'b' + 'c', 'abc');
assert.equal('take ' + 3 + ' oranges', 'take 3 oranges');
```

#### 18.7.4ã€‚ `String.prototype`ï¼šå¯»æ‰¾å’ŒåŒ¹é…

*   `.endsWith(searchString: string, endPos=this.length): boolean` <sup>[ES6]</sup>

    å¦‚æœå­—ç¬¦ä¸²çš„é•¿åº¦ä¸º`endPos`çš„å­ä¸²ä»¥`searchString`ç»“æŸï¼Œåˆ™è¿”å›`true`ã€‚å¦åˆ™è¿”å›`false`ã€‚
    
    ```js
    > 'foo.txt'.endsWith('.txt')
    true
    > 'abcde'.endsWith('cd', 4)
    true
    ```

*   `.includes(searchString: string, startPos=0): boolean` <sup>[ES6]</sup>

    å¦‚æœå­—ç¬¦ä¸²åŒ…å«`searchString`ï¼Œåˆ™è¿”å›`true`ï¼Œå¦åˆ™ä¸º`false`ã€‚æœç´¢ä»`startPos`å¼€å§‹ã€‚
    
    ```js
    > 'abc'.includes('b')
    true
    > 'abc'.includes('b', 2)
    false
    ```

*   `.indexOf(searchString: string, minIndex=0): number` <sup>[ES1]</sup>

    è¿”å›å­—ç¬¦ä¸²ä¸­`searchString`å‡ºç°çš„æœ€ä½ç´¢å¼•ï¼Œå¦åˆ™è¿”å›`-1`ã€‚ä»»ä½•è¿”å›çš„ç´¢å¼•éƒ½æ˜¯`minIndex`æˆ–æ›´é«˜ã€‚
    
    ```js
    > 'abab'.indexOf('a')
    0
    > 'abab'.indexOf('a', 1)
    2
    > 'abab'.indexOf('c')
    -1
    ```

*   `.lastIndexOf(searchString: string, maxIndex=Infinity): number` <sup>[ES1]</sup>

    è¿”å›å­—ç¬¦ä¸²ä¸­å‡ºç°`searchString`çš„æœ€é«˜ç´¢å¼•ï¼Œå¦åˆ™è¿”å›`-1`ã€‚ä»»ä½•è¿”å›çš„ç´¢å¼•éƒ½æ˜¯`maxIndex`æˆ–æ›´ä½ã€‚
    
    ```js
    > 'abab'.lastIndexOf('ab', 2)
    2
    > 'abab'.lastIndexOf('ab', 1)
    0
    > 'abab'.lastIndexOf('ab')
    2
    ```

*   `.match(regExp: string | RegExp): RegExpMatchArray | null` <sup>[ES3]</sup>

    å¦‚æœ`regExp`æ˜¯æœªè®¾ç½®æ ‡å¿—`/g`çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåˆ™`.match()`è¿”å›å­—ç¬¦ä¸²ä¸­`regExp`çš„ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ã€‚æˆ–è€…å¦‚æœæ²¡æœ‰åŒ¹é…é¡¹åˆ™ä¸º`null`ã€‚å¦‚æœ`regExp`æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™åœ¨æ‰§è¡Œå‰é¢çš„æ­¥éª¤ä¹‹å‰ï¼Œå®ƒç”¨äºåˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ã€‚

    ç»“æœå…·æœ‰ä»¥ä¸‹ç±»å‹ï¼š
    
    ```js
    interface RegExpMatchArray extends Array<string> {
      index: number;
      input: string;
      groups: undefined | {
        [key: string]: string
      };
    }
    ```

    ç¼–å·æ•è·ç»„æˆä¸ºæ•°ç»„ç´¢å¼•ã€‚ [å‘½åæ•è·ç»„](http://exploringjs.com/es2018-es2019/ch_regexp-named-capture-groups.html)ï¼ˆES2018ï¼‰æˆä¸º`.groups`çš„å±æ€§ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œ`.match()`çš„ä½œç”¨ç±»ä¼¼äº`RegExp.prototype.exec()`ã€‚

    ä¾‹å­ï¼š
    
    ```js
    > 'ababb'.match(/a(b+)/)
    { 0: 'ab', 1: 'b', index: 0, input: 'ababb', groups: undefined }
    > 'ababb'.match(/a(?<foo>b+)/)
    { 0: 'ab', 1: 'b', index: 0, input: 'ababb', groups: { foo: 'b' } }
    > 'abab'.match(/x/)
    null
    ```

*   `.match(regExp: RegExp): string[] | null` <sup>[ES3]</sup>

    å¦‚æœè®¾ç½®äº†`regExp`çš„æ ‡å¿—`/g`ï¼Œ`.match()`å°†è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰åŒ¹é…é¡¹çš„æ•°ç»„ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…é¡¹åˆ™è¿”å›`null`ã€‚
    
    ```js
    > 'ababb'.match(/a(b+)/g)
    [ 'ab', 'abb' ]
    > 'ababb'.match(/a(?<foo>b+)/g)
    [ 'ab', 'abb' ]
    > 'abab'.match(/x/g)
    null
    ```

*   `.search(regExp: string | RegExp): number` <sup>[ES3]</sup>

    è¿”å›å­—ç¬¦ä¸²ä¸­`regExp`å‡ºç°çš„ç´¢å¼•ã€‚å¦‚æœ`regExp`æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ç”¨äºåˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ã€‚
    
    ```js
    > 'a2b'.search(/[0-9]/)
    1
    > 'a2b'.search('[0-9]')
    1
    ```

*   `.startsWith(searchString: string, startPos=0): boolean` <sup>[ES6]</sup>

    å¦‚æœ`searchString`å‡ºç°å­—ç¬¦ä¸²ä¸­ç´¢å¼•`startPos`å¤„ï¼Œåˆ™è¿”å›`true`ã€‚å¦åˆ™è¿”å›`false`ã€‚
    
    ```js
    > '.gitignore'.startsWith('.')
    true
    > 'abcde'.startsWith('bc', 1)
    true
    ```

#### 18.7.5ã€‚ `String.prototype`ï¼šæå–

*   `.slice(start=0, end=this.length): string` <sup>[ES3]</sup>

    è¿”å›ä»ç´¢å¼•`start`å¼€å§‹ï¼ˆåŒ…æ‹¬ï¼‰å¹¶ä»¥ç´¢å¼•`end`ç»“æŸï¼ˆä¸åŒ…æ‹¬ï¼‰çš„å­—ç¬¦ä¸²çš„å­ä¸²ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è´ŸæŒ‡æ•°ï¼Œå…¶ä¸­`-1`è¡¨ç¤º`this.length-1`ï¼ˆä»¥æ­¤ç±»æ¨ï¼‰ã€‚
    
    ```js
    > 'abc'.slice(1, 3)
    'bc'
    > 'abc'.slice(1)
    'bc'
    > 'abc'.slice(-2)
    'bc'
    ```

*   `.split(separator: string | RegExp, limit?: number): string[]` <sup>[ES3]</sup>

    å°†å­—ç¬¦ä¸²æ‹†åˆ†ä¸ºå­å­—ç¬¦ä¸²æ•°ç»„ - åˆ†éš”ç¬¦ä¹‹é—´å‡ºç°çš„å­—ç¬¦ä¸²ã€‚åˆ†éš”ç¬¦å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ã€‚æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„æ•è·ç»„åŒ…å«åœ¨ç»“æœä¸­ã€‚
    
    ```js
    > 'abc'.split('')
    [ 'a', 'b', 'c' ]
    > 'a | b | c'.split('|')
    [ 'a ', ' b ', ' c' ]

    > 'a : b : c'.split(/ *: */)
    [ 'a', 'b', 'c' ]
    > 'a : b : c'.split(/( *):( *)/)
    [ 'a', ' ', ' ', 'b', ' ', ' ', 'c' ]
    ```

*   `.substring(start: number, end=this.length): string` <sup>[ES1]</sup>

    ä½¿ç”¨`.slice()`ä»£æ›¿æ­¤æ–¹æ³•ã€‚ `.substring()`æœªåœ¨æ—§å¼•æ“ä¸­ä¸€è‡´åœ°å®ç°ï¼Œå¹¶ä¸”ä¸æ”¯æŒè´ŸæŒ‡æ•°ã€‚

#### 18.7.6ã€‚ `String.prototype`ï¼šåˆå¹¶

*   `.concat(...strings: string[]): string` <sup>[ES3]</sup>

    è¿”å›å­—ç¬¦ä¸²å’Œ`strings`çš„è¿æ¥ã€‚ `'a'+'b'`ç›¸å½“äº`'a'.concat('b')`ï¼Œæ›´ç®€æ´ã€‚
    
    ```js
    > 'ab'.concat('cd', 'ef', 'gh')
    'abcdefgh'
    ```

*   `.padEnd(len: number, fillString=' '): string` <sup>[ES2017]</sup>

    å°†`fillString`è¿½åŠ åˆ°å­—ç¬¦ä¸²ï¼Œç›´åˆ°å®ƒå…·æœ‰æ‰€éœ€çš„é•¿åº¦`len`ã€‚
    
    ```js
    > '#'.padEnd(2)
    '# '
    > 'abc'.padEnd(2)
    'abc'
    > '#'.padEnd(5, 'abc')
    '#abca'
    ```

*   `.padStart(len: number, fillString=' '): string` <sup>[ES2017]</sup>

    å°†`fillString`æ·»åŠ åˆ°å­—ç¬¦ä¸²å¤´éƒ¨ï¼Œç›´åˆ°å®ƒå…·æœ‰æ‰€éœ€çš„é•¿åº¦`len`ã€‚
    
    ```js
    > '#'.padStart(2)
    ' #'
    > 'abc'.padStart(2)
    'abc'
    > '#'.padStart(5, 'abc')
    'abca#'
    ```

*   `.repeat(count=0): string` <sup>[ES6]</sup>

    è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‡å¤`count`æ¬¡ã€‚
    
    ```js
    > '*'.repeat()
    ''
    > '*'.repeat(3)
    '***'
    ```

#### 18.7.7ã€‚ `String.prototype`ï¼šè½¬æ¢

*   `.normalize(form: 'NFC'|'NFD'|'NFKC'|'NFKD' = 'NFC'): string` <sup>[ES6]</sup>

    æ ¹æ® [Unicode è§„èŒƒåŒ–å½¢å¼](https://unicode.org/reports/tr15/)è§„èŒƒåŒ–å­—ç¬¦ä¸²ã€‚

*   `.replace(searchValue: string | RegExp, replaceValue: string): string` <sup>[ES3]</sup>

    å°†`searchValue`çš„åŒ¹é…é¡¹æ›¿æ¢ä¸º`replaceValue`ã€‚å¦‚æœ`searchValue`æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™åªæ›¿æ¢ç¬¬ä¸€ä¸ªå‡ºç°ä½ç½®ã€‚å¦‚æœ`searchValue`æ˜¯æ²¡æœ‰æ ‡å¿—`/g`çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåˆ™ä»…æ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ã€‚å¦‚æœ`searchValue`æ˜¯å¸¦æœ‰`/g`çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåˆ™æ›¿æ¢æ‰€æœ‰åŒ¹é…é¡¹ã€‚
    
    ```js
    > 'x.x.'.replace('.', '#')
    'x#x.'
    > 'x.x.'.replace(/./, '#')
    '#.x.'
    > 'x.x.'.replace(/./g, '#')
    '####'
    ```

    `replaceValue`ä¸­çš„ç‰¹æ®Šå­—ç¬¦æ˜¯ï¼š

    *   `$$`ï¼šæˆä¸º`$`
    *   `$n`ï¼šæˆä¸ºç¼–å·æ•è·ç»„`n`ï¼ˆå”‰ï¼Œ`$0`ä¸èµ·ä½œç”¨ï¼‰
    *   `$&`ï¼šæˆä¸ºå®Œå…¨åŒ¹é…é¡¹
    *   `$``ï¼šæˆä¸ºåŒ¹é…é¡¹å‰çš„ä»»ä½•ä¸œè¥¿
    *   `$'`ï¼šæˆä¸ºåŒ¹é…é¡¹åçš„ä»»ä½•ä¸œè¥¿

    ä¾‹å­ï¼š
    
    ```js
    > 'a 2020-04 b'.replace(/([0-9]{4})-([0-9]{2})/, '|$2|')
    'a |04| b'
    > 'a 2020-04 b'.replace(/([0-9]{4})-([0-9]{2})/, '|$&|')
    'a |2020-04| b'
    > 'a 2020-04 b'.replace(/([0-9]{4})-([0-9]{2})/, '|$`|')
    'a |a | b'
    ```

    [ä¹Ÿæ”¯æŒå‘½åæ•è·ç»„](http://exploringjs.com/es2018-es2019/ch_regexp-named-capture-groups.html)ï¼ˆES2018ï¼‰ï¼š

    *   `$<name>`æˆä¸ºå‘½åæ•è·ç»„`name

    ä¾‹ï¼š
    
    ```js
    > 'a 2020-04 b'.replace(/(?<year>[0-9]{4})-(?<month>[0-9]{2})/, '|$<month>|')
    'a |04| b'
    ```

*   `.replace(searchValue: string | RegExp, replacer: (...args: any[]) => string): string` <sup>[ES3]</sup>

    å¦‚æœç¬¬äºŒä¸ªå‚æ•°æ˜¯å‡½æ•°ï¼Œåˆ™æ›¿æ¢ä¸ºå…¶è¿”å›çš„å­—ç¬¦ä¸²ã€‚å…¶å‚æ•°`args`æ˜¯ï¼š

    *   `matched: string`ï¼šå®Œå…¨åŒ¹é…é¡¹
    *   `g1: string|undefined`ï¼šç¼–å·æ•è·ç»„ 1
    *   `g2: string|undefined`ï¼šç¼–å·æ•è·ç»„ 2
    *   ï¼ˆç­‰ç­‰ï¼‰
    *   `offset: number`ï¼šåœ¨è¾“å…¥å­—ç¬¦ä¸²ä¸­æ‰¾åˆ°åŒ¹é…é¡¹çš„ä½ç½®ï¼Ÿ
    *   `input: string`ï¼šæ•´ä¸ªè¾“å…¥å­—ç¬¦ä¸²
    
    ```js
    const regexp = /([0-9]{4})-([0-9]{2})/;
    const replacer = (all, year, month) => '|' + all + '|';
    assert.equal(
      'a 2020-04 b'.replace(regexp, replacer),
      'a |2020-04| b');
    ```

    [ä¹Ÿæ”¯æŒå‘½åæ•è·ç»„](http://exploringjs.com/es2018-es2019/ch_regexp-named-capture-groups.html)ï¼ˆES2018ï¼‰ã€‚å¦‚æœæœ‰ï¼Œåˆ™æœ€åä¸€ä¸ªå‚æ•°åŒ…å«ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶å±æ€§åŒ…å«æ•è·ç»„ï¼š
    
    ```js
    const regexp = /(?<year>[0-9]{4})-(?<month>[0-9]{2})/;
    const replacer = (...args) => {
      const groups=args.pop();
      return '|' + groups.month + '|';
    };
    assert.equal(
      'a 2020-04 b'.replace(regexp, replacer),
      'a |04| b');
    ```

*   `.toUpperCase(): string` <sup>[ES1]</sup>

    è¿”å›å­—ç¬¦ä¸²çš„å‰¯æœ¬ï¼Œå…¶ä¸­æ‰€æœ‰å°å†™å­—æ¯å­—ç¬¦éƒ½è½¬æ¢ä¸ºå¤§å†™ã€‚å¯¹äºå„ç§å­—æ¯è¡¨çš„æ•ˆæœå–å†³äº JavaScript å¼•æ“ã€‚
    
    ```js
    > '-a2b-'.toUpperCase()
    '-A2B-'
    > 'Î±Î²Î³'.toUpperCase()
    'Î‘Î’Î“
    ```

*   `.toLowerCase(): string` <sup>[ES1]</sup>

    è¿”å›å­—ç¬¦ä¸²çš„å‰¯æœ¬ï¼Œå…¶ä¸­æ‰€æœ‰å¤§å†™å­—æ¯å­—ç¬¦éƒ½è½¬æ¢ä¸ºå°å†™ã€‚å¯¹äºå„ç§å­—æ¯è¡¨çš„æ•ˆæœå–å†³äº JavaScript å¼•æ“ã€‚
    
    ```js
    > '-A2B-'.toLowerCase()
    '-a2b-'
    > 'Î‘Î’Î“'.toLowerCase()
    'Î±Î²Î³'
    ```

*   `.trim(): string` <sup>[ES5]</sup>

    è¿”å›å­—ç¬¦ä¸²çš„å‰¯æœ¬ï¼Œå…¶ä¸­æ‰€æœ‰å‰å¯¼å’Œå°¾éšç©ºç™½ï¼ˆç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦ï¼Œè¡Œç»ˆæ­¢ç¬¦ç­‰ï¼‰éƒ½å»æ‰äº†ã€‚
    
    ```js
    > '\r\n#\t  '.trim()
    '#'
    ```

*   `.trimEnd(): string` <sup>[ES2019]</sup>

    ä¸`.trim()`ç±»ä¼¼ï¼Œä½†ä»…ä¿®å‰ªå­—ç¬¦ä¸²çš„æœ«å°¾ï¼š
    
    ```js
    > '  abc  '.trimEnd()
    '  abc'
    ```

*   `.trimStart(): string` <sup>[ES2019]</sup>

    ä¸`.trim()`ç±»ä¼¼ï¼Œä½†ä»…ä¿®å‰ªå­—ç¬¦ä¸²çš„å¼€å¤´ï¼š
    
    ```js
    > '  abc  '.trimStart()
    'abc  '
    ```

#### 18.7.8ã€‚ `String.prototype`ï¼šå­—ç¬¦ï¼Œå­—ç¬¦ä»£ç ï¼Œä»£ç ç‚¹

*   `.charAt(pos: number): string` <sup>[ES1]</sup>

    è¿”å›ç´¢å¼•`pos`å¤„çš„å­—ç¬¦ï¼Œä½œä¸ºå­—ç¬¦ä¸²ï¼ˆJavaScript æ²¡æœ‰å­—ç¬¦çš„æ•°æ®ç±»å‹ï¼‰ã€‚ `str[i]`ç­‰åŒäº`str.charAt(i)`å¹¶ä¸”æ›´ç®€æ´ï¼ˆè­¦å‘Šï¼šå¯èƒ½ä¸é€‚ç”¨äºæ—§å¼•æ“ï¼‰ã€‚
    
    ```js
    > 'abc'.charAt(1)
    'b'
    ```

*   `.charCodeAt(pos: number): number` <sup>[ES1]</sup>

    è¿”å›ç´¢å¼•`pos`å¤„çš„ UTF-16 ä»£ç å•å…ƒï¼ˆå­—ç¬¦ï¼‰çš„ 16 ä½æ•°å­—ï¼ˆ0-65535ï¼‰ã€‚
    
    ```js
    > 'abc'.charCodeAt(1)
    98
    ```

*   `.codePointAt(pos: number): number | undefined` <sup>[ES6]</sup>

    è¿”å›ç´¢å¼•`pos`å¤„ 1-2 ä¸ªå­—ç¬¦çš„ Unicode ä»£ç ç‚¹çš„ 21 ä½æ•°ã€‚å¦‚æœæ²¡æœ‰è¿™æ ·çš„ç´¢å¼•ï¼Œåˆ™è¿”å›`undefined`ã€‚

#### 18.7.9ã€‚æ¥æº

*   [TypeScript çš„å†…ç½®ç±»å‹](https://github.com/Microsoft/TypeScript/blob/master/lib/)
*   [JavaScript çš„ MDN ç½‘ç»œæ–‡æ¡£](https://developer.mozilla.org/en-US/docs/Web/JavaScript)
*   [ECMAScript è¯­è¨€è§„èŒƒ](https://tc39.github.io/ecma262/)

![](img/326f85074b5e7828bef014ad113651df.svg) **ç»ƒä¹ ï¼šä½¿ç”¨å­—ç¬¦ä¸²æ–¹æ³•**

`exercises/strings/remove_extension_test.js`

![](img/bf533f04c482f83bfc407f318306f995.svg) **æµ‹éªŒ**

å‚è§[æµ‹éªŒåº”ç”¨ç¨‹åº](ch_quizzes-exercises.html#quizzes)ã€‚